# MySQL-specific code to create tables for auction server.


# as_site_details contains details about this installation.
CREATE TABLE as_site_details (
  uuid               CHAR(36)       NOT NULL,   # UUID identifying this auction site.
  name               VARCHAR(64)    NOT NULL,   # Name for this site.
  uri                VARCHAR(256),              # URI at which the server is available to its users.
  language           VARCHAR(5),                # Language of the site, such as en, or pt_BR.
  template           VARCHAR(64)                # Website design template for the site to use.
);

insert into as_site_details values('bbbab125-1968-4149-89f6-47100f3b92bb', 'Test Auction Server', 'locoalhost:8081/auctionserver/', 'en', 'responsive');


# as_users contains users registered with this site.
CREATE TABLE as_users (
  uuid               CHAR(36)       NOT NULL,   # User UUID.
  login              VARCHAR(32)    NOT NULL,   # User login.
  password           CHAR(32)       NOT NULL,   # Password hash.
  name               VARCHAR(64)    NOT NULL,   # User name.
  email              VARCHAR(64)    NOT NULL,   # User email.
  status             INTEGER,                   # User status.
  PRIMARY KEY (login)
);

insert into as_users values('aaaab125-1968-4149-89f6-47100f3b92bb', 'test', md5('test'), 'Test', 'test@example.com', 1);


# as_currencies contains currency symbols supported by this site.
CREATE TABLE as_currencies (
  currency           CHAR(3)        NOT NULL,   # Currency symbol: USD, CAD, NZD, etc.
  ord_num            INTEGER,                   # Ordering number for currency list.
  PRIMARY KEY (currency)
);

# Insert some currencies.
insert into as_currencies values('USD', 0);
insert into as_currencies values('NZD', 10);
insert into as_currencies values('AUD', 20);
insert into as_currencies values('EUR', 30);
insert into as_currencies values('CAD', 40);


# as_durations contains possible auction duration intervals in days supported by this site.
CREATE TABLE as_durations (
  duration           INTEGER        NOT NULL,   # Auction duration in days.
  ord_num            INTEGER,                   # Ordering number for duration dropdown.
  PRIMARY KEY (duration)
);

# Insert some durations.
insert into as_durations values(30, 0);
insert into as_durations values(10, 10);
insert into as_durations values(7, 20);
insert into as_durations values(3, 30);


# as_auctions contains auctions known to this site (local and remote).
CREATE TABLE as_auctions (
  uuid               CHAR(36)       NOT NULL,   # UUID of the auction, generated by the site.
  origin             CHAR(36)       NOT NULL,   # Originating node UUID.
  seller_uuid        CHAR(36)       NOT NULL,   # Seller UUID.
  name               VARCHAR(256)   NOT NULL,   # Name of the auction item.
  description        TEXT,                      # Description of the auction item.
  image_uri          VARCHAR(256),              # Image URI.
  created_timestamp  CHAR(19)       NOT NULL,   # Creation timestamp in format like "2016-04-08 15:00:10".
  close_timestamp    CHAR(19)       NOT NULL,   # Close timestamp in format like "2016-04-15 15:00:10".
  currency           CHAR(3)        NOT NULL,   # Currency: USD, CAD, NZD, etc.
  reserve_price      NUMERIC(15,2),             # Reserve price of the auction.
  current_price      NUMERIC(15,2),             # Current price of the auction.
  approved           INTEGER,                   # Whether the auction is approved for site.
  status             INTEGER,                   # Status of the auction.
  PRIMARY KEY (uuid)
);
# TODO: add indexes.


# as_bids contains bids known to ths server.
CREATE TABLE as_bids (
  uuid               CHAR(36)       NOT NULL,   # UUID of the bid.
  origin             CHAR(36),                  # Site UUID for the bid origin.
  item_uuid          CHAR(36)       NOT NULL,   # UUID of the auction item.
  item_origin        CHAR(36),                  # Site UUID for item origin.
  max_price          NUMERIC(15,2),             # Max price of the pid.
  user_uuid          CHAR(36)       NOT NULL,   # User UUID who placed the bid.
  created_timestamp  CHAR(19)       NOT NULL,   # Bid creation timestamp in format like "2016-04-08 15:01:10".
  status             INTEGER,                   # Status of the bid.
  PRIMARY KEY (uuid)
);
# TODO: add indexes.

